---
layout: post
title: JavaScript 入門 (1)
---

# JavaScript 入門 (1)

書籍『Unity 入門』の内容は、何らかのプログラミングを経験済みである人を対象としており、プログラミングの基礎については解説していません。既に「プログラミングとは何か」というイメージを持っている人が読むと、進めるうちに何となくやり方が分かってくるという流れを想定しています。

ここではプログラミングの経験がまったく無い人を対象として、 Unity に搭載されている JavaScript の使い方を解説していきます。

## スクリプトって？

**スクリプト** (script) とは英語で「脚本」とか「台本」を意味する単語です。コンピュータの世界においては**ソフトウェアを制御するためのプログラム**のことを指して言います。スクリプトを記述するために使われる特殊な言語のことを**スクリプト言語**と言います。

一般化して説明するとこんな感じですが、まあ Unity の世界では「ゲームオブジェクトを動かすための指示書」みたいなもんだと思っておけばいいでしょう。例えば、あるゲームオブジェクトに "Dance" という名前のアニメーションを再生させたいと思ったら、スクリプトにこんな感じのことを書きます。

    animation.Play("Dance");

`animation` に `"Dance"` を `Play` しろ！ ……って、まあそのまんまのことを書くわけですね。

ただ、スクリプトにはただ闇雲にそれっぽいことを書いていけばいいわけではありません。指示を記述するための一定のルールが存在します。 Unity が理解できる言葉（言語）を使う必要があるのです。

ここでは、その Unity が理解できる言葉のひとつである **JavaScript** について学んでいくことにしましょう。

## まずは Hello world!

まずは定番の [Hello world プログラム](http://ja.wikipedia.org/wiki/Hello_world)を作ってみることにしましょう。 "Hello, world!" と出力するだけの簡単なスクリプトです。

### スクリプト作成の準備

なにはともあれ、新規プロジェクトを作成します。 File メニューから New Project... を選択します。

![New project](/articles/images/js_tutor1_01.png)

プロジェクトを作成するディレクトリを決めます。名前は何でもいいです。ここではとりあえず "ScriptStudy" プロジェクトとしてみました。

![Project creation dialog box](/articles/images/js_tutor1_02.png)

新規プロジェクトができたら、プロジェクト内のアセットとして JavaScript を新規作成します。 Project ビューの上部分にある "Create" メニューから "JavaScript" を選択するだけです。

![New JavaScript](/articles/images/js_tutor1_03.png)

新規作成した JavaScript の名前は "NewBehaviourScript" となっています。このまま使っても問題ありませんが、とりあえずそれっぽい名前に変えておきましょうか。ここでは "Test" という名前にしてみました。

![Renaming JavaScript file](/articles/images/js_tutor1_04.png)

スクリプトファイルをダブルクリックすると、スクリプトを編集するための**スクリプトエディタ**が起動します。標準では **MonoDevelop** という本格的なプログラミング環境が起動するようになっています。

![MonoDevelop](/articles/images/js_tutor1_05.png)

ちょっと本格的過ぎて筆者はあまり好きではないのですが……まあとりあえずコレを使っていくことにしましょう。

### スクリプトを書く

新規作成された JavaScript の中身は、次のようになっています。

    function Update () {
    }

これは Unity でよく使われる **Update 関数**の雛形です。今回は使わないので、まずこの2行を削除して空っぽにしてしまいましょう。

そして、次のような内容にします。

    print("Hello, world!");

これは **Console ビュー** に "Hello, world!" というテキストを出力するスクリプトです。

大文字、小文字は間違えないよう正確に入力してください。記号も間違えないように気をつけましょう。ここで使っているのは、通常の括弧、引用符はダブルクォーテーション、文末の記号はセミコロンです。入力を終えたら MonoDevelop 上でファイルを保存します。

さて、このスクリプトを実行するには、スクリプトをどこかのゲームオブジェクトに与える必要があります。とりあえず Cube でも配置して、そこにスクリプトを与えることにしましょうか。

![Create a cube](/articles/images/js_tutor1_06.png)

こうして作った Cube に Test スクリプトをドラッグ＆ドロップして加えます。

![Drag and drop](/articles/images/js_tutor1_07.png)

ちゃんと Cube に Test スクリプトが追加されたかどうか、 Inspector ビューで確認してみましょう。 Hierarchy ビュー上で Cube を選択してから Inspector ビューを見てみると、次のように末尾に Test Script が追加されているはずです。

![Inspector view](/articles/images/js_tutor1_08.png)

いよいよ実行です。ツールバーの Play ボタンを押してゲームを開始します。 Console ビューを開いて出力を確認してみましょう。

![Open console view](/articles/images/js_tutor1_09.png)

次のように出力されているはずです。

![Output](/articles/images/js_tutor1_10.png)

動きました！  これで JavaScript の第一ミッションは終了です

## Hello, world! の内容

この非常に単純な1行のスクリプトについて、詳しく解説してみましょう。

まず最初に記している `print` について。これはコンピューターに対する命令のようなものだと考えてください。 `print` は「後に続く括弧の中身を Console に出力する」という命令です。

括弧の中には引用符（ダブルクォーテーション「`"`」）で括った文章を記述しました。このように引用符で括るのはJavaScript上で**文字列**を記す際のルールです。ちなみに「文字列」とは、複数の文字が連なってできたデータのことで、つまり文章のことを表すと考えてください。

最後に添えられたセミコロン（`;`）は、スクリプトの文がひとつ終わったことを表すものです。JavaScript では、このセミコロンまでがひと区切りとなります。

## 数値を扱う

さて、単純な文字列を出力する方法はこれで分かりました。次はもうちょっと別のものを出力してみましょう。

まずは数値です。 Test スクリプトを次のように変更します。

    print(100);

これを実行すると、次のように Console に出力されます。

    100

このように引用符無しで数値を書くと、それは**数値**として認識されます。

数値の場合は文字列と違って計算ができます。スクリプトを次のようにして実行してみましょう。

    print(123 + 456);

出力は次のようになります。

    579

掛け算にはアスタリスク (\*)、割り算にはスラッシュ (/) を使います。括弧や小数点を使うこともできます。

   print( (1 + 2) * 3 / 4.56 );

出力は次のようになります。

    1.97368421053

## 文字列の足し算

JavaScriptでは文字列も足し算することができます。ただし文字列の足し算は「ふたつの文字列を繋げる」という意味合いを持っています。

例えば次のようにすると、 `"Unity"` と `"Script"` というふたつの文字列が繋げられて `UnityScript` と出力されます。

    print("Unity" + "Script");

また面白い機能として「文字列に対して数値を足し算する」というものもあります。これにより文字列と数値を繋げて出力することが可能になります。例えば次のスクリプトを実行すると Console には `My number is 100` と出力されます。

    print("My number is " + 100);

それでは `My number is` の後に `100 + 100` の計算結果を出力するには、どうしたらよいでしょう？ 

    print("My number is " + 100 + 100);

これは不正解です。これを実行してみると Console には `My number is 100100` と表示されてしまいます。これは「足し算は左から順に行われる」という計算順序のルールがあるためです。

図

これを防ぐには括弧を使って明確に計算順序を指定する必要があります。

    print("My number is " + (100 + 100));

これなら `My number is 200` と表示されるはずです。

## 変数を使う

スクリプトで文字列や数値を使う方法はこれで分かりました。しかしこれらの文字列や数値は、スクリプトの中に記述されたもので、後から変更することができません。ゲームのスクリプトを組むにあたっては、例えばプレイヤーが入力した文字列や、ゲーム内のオブジェクトの現在の数値などを元にして、様々な処理を行う必要があるはずです。

このように、スクリプト中で変化する値を扱うために用意されているのが**変数**と呼ばれる概念です。

例えば、前のセクションでは100という数値を出力するために、次のようなスクリプトを作成しました。

    print(100);

変数を使って同じことをやってみましょう。変数にはそれぞれ名前を付けることができます。ここでは `num1` という名前を使うことにしましょう。次のように記述します。

    var num1 = 100;

先頭にある `var` は「今から新しい変数を定義するよ」という*宣言*です。その直後には変数の名前を記します。そしてその後には `=` を書きました。これは「この後に書く値を変数に入れてくれ」という指示で、「変数への*代入*」と呼びます。値は100としました。文の最後にはお決まりのセミコロンを置きます。

こうして宣言した変数を使うには、スクリプトの中に変数の名前をそのまま記します。例えば変数 `num1` の内容を出力するには次のようにします。

    var num1 = 100;
    print(num1);

文字列も同様に変数へ代入することができます。例えば変数 `name` に文字列 `"Unity"` を代入するには、次のようにします。

    var name = "Unity";

計算も数値や文字列に対して行ったのと同様にできます。次のようにすると Console には `Unity is born in 2001` と出力されます。

    var name = "Unity";
    var birth = 2001;
    print(name + " is born in " + birth);



