<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <title>Unity入門 - ミドルウェア (12)</title>
  <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
  <link rel="stylesheet" href="/css/screen.css" type="text/css" />
</head>

<body>

<div id="site">
  <div id="title"></div>
  <div id="navigation">
    <ul>
      <li><a href="/index.html">HOME</a></li>
      <li><a href="/examples.html">EXAMPLES</a></li>
      <li><a href="/downloads.html">DOWNLOADS</a></li>
      <li><a href="/faq.html">FAQ</a></li>
      <li><a href="/errata.html">ERRATA</a></li>
      <li><a href="http://www.sbcr.jp/products/4797365337.html">BOOK</a></li>
    </ul>
  </div>

  <div id="toolbar">
<div id="tweet_button"><a href="https://twitter.com/share" class="twitter-share-button" data-url="http://unity-yb.github.com" data-count="horizontal">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"></script></div>
<div id="facebook_button"><div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=260331134000866&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="fb-like" data-href="http://unity-yb.github.com/" data-send="false" data-layout="button_count" data-show-faces="false"></div>
</div>
  </div>
  
  <div id="post">
<h1 id='_12'>ミドルウェア (12)</h1>

<h2 id='id1986'>オブジェクト間連携</h2>

<p>複数のゲームオブジェクトが相互に連携して動作するための仕組みを学ぶ。</p>

<h2 id='id1987'>雛形のインポート</h2>

<p>今回の例題の雛形部分を用意しておいた。下記ファイルをダウンロードしてインポートすること。</p>

<p>http://vga-unity.googlecode.com/files/MessagingExample.unitypackage</p>

<p>インポートが完了したらExampleシーンをダブルクリックで開く。</p>

<p>このシーンは、ふたつの箱(Box1, Box2)と、壁(Wall)から構成される。ふたつの箱は、実行開始から1.5秒後に左に向かって移動を開始する。壁はトリガーとなっており、コリジョンは発生しないが、トリガーに触れたゲームオブジェクトの名前をコンソールに出力する。</p>

<p>ふたつの箱には、それぞれFlickerスクリプトとBlinkerスクリプトが付けられている。これらのスクリプトによって、箱は常に点滅している。</p>

<p>今回の例題は、これらの箱が壁に触れたとき、点滅を止めることを目標にする。</p>

<h2 id='id1988'>方法その１・コンポーネントへの直接アクセス</h2>

<p><strong>コンポーネント</strong>(Component)とは「部品」のこと。Unityにおける<code>Transform</code>とか<code>Rigidbody</code>とか<code>BoxCollider</code>とかは、全部コンポーネント。</p>

<p>ユーザーが書いたスクリプトもコンポーネントとして扱うことができる。例えばBoxスクリプトはBoxコンポーネントとなる。</p>

<p>Unityに用意されている標準的なコンポーネントについては、<code>transform</code>や<code>rigidbody</code>や<code>collider</code>などのように、プロパティ経由で簡単にアクセスできる。しかし、レアなコンポーネントや、ユーザーが自作したコンポーネントへは<code>GetComponent</code>を使わないとアクセスできない。</p>

<h2 id='id1989'>箱の点滅を止めるには</h2>

<p>まず、<code>Flicker</code>/<code>Blinker</code>スクリプトに、点滅を止めるための関数を用意する。</p>

<p>次に、Wallスクリプトの中で<code>Flicker</code>/<code>Blinker</code>コンポーネントへのアクセスを取得し、そこから点滅を止めるための関数を呼び出す。</p>

<h3 id='flicker'>Flickerの拡張</h3>

<p><code>stopFlag</code>を用意し、<code>StopUpdate</code>関数を呼ぶと止まるようにする。</p>

<pre><code>private var stopFlag : boolean;

function StopUpdate() {
    stopFlag = true;
}

function Update() {
    if (!stopFlag) {
        var red : float = Mathf.Sin(Time.time * 100.0);
        renderer.material.color = Color(red, 0, 0, 0);
    }
}</code></pre>
</div>

  
  <div id="footer">© 2011 KEIJIRO TAKAHASHI</div>
</div>
</body>
</html>
